<?xml version="1.0" encoding="utf-8"?>
<j:ResponsiveView xmlns:fx="http://ns.adobe.com/mxml/2009"
    xmlns:j="library://ns.apache.org/royale/jewel"
    xmlns:js="library://ns.apache.org/royale/basic"
    xmlns:html="library://ns.apache.org/royale/html"
	xmlns:views="*" 
    initComplete="onInit()"
    stateChangeComplete="onChangeState(event)">

    <fx:Script>
        <![CDATA[
            
        import org.apache.royale.events.Event;

        private function onInit():void
        {
            currentState = "init";
        }

        private function onChangeStateView(event:Event):void
        {
            if(currentState != event.currentTarget.currentState)
                currentState = event.currentTarget.currentState;

            trace('Main onChangeStateView',currentState);
        }

        private function onChangeState(event:Event):void
        {
            trace('Main onChangeState',currentState);

            if( currentState == "init")
                main.selectedContent = "vlogin";
            else if( currentState == "loggedIn")
                main.selectedContent = "vloginOk";
            else if( currentState == "error")
                main.selectedContent = "vloginNoOk";
        }

        ]]>
    </fx:Script>

    <j:beads>
		<js:SimpleStatesImpl/>
		<js:ViewDataBinding/>
	</j:beads>

    <j:states>
        <js:State name="noinit" />
        <js:State name="init" />
        <js:State name="loggedIn" />
        <js:State name="error" />
    </j:states>

     <j:ApplicationMainContent localId="main">
        
        <j:SectionContent name="vdesktop">
            <j:VGroup percentHeight="100" percentWidth="100" itemsHorizontalAlign="itemsCenter" itemsVerticalAlign="itemsCenter">
                <html:H1 text="Test Binding"/>
            </j:VGroup>
        </j:SectionContent>

        <j:SectionContent name="vlogin">
            <views:ViewTestBinding percentHeight="100" percentWidth="100" itemsHorizontalAlign="itemsCenter" itemsVerticalAlign="itemsCenter" 
            currentState="{currentState}" stateChangeComplete="onChangeStateView(event)" />
        </j:SectionContent>
        
        <j:SectionContent name="vloginOk">
            <j:VGroup percentHeight="100" percentWidth="100" itemsHorizontalAlign="itemsCenter" itemsVerticalAlign="itemsCenter">
                <html:H1 text="Login Correcto"/>
            </j:VGroup>
        </j:SectionContent>
        
        <j:SectionContent name="vloginNoOk">
            <j:VGroup percentHeight="100" percentWidth="100" itemsHorizontalAlign="itemsCenter" itemsVerticalAlign="itemsCenter">
                <html:H1 text="Login Incorrecto"/>
                <j:Button text="Re-Init" emphasis="primary" click="currentState='init';" />
            </j:VGroup>
        </j:SectionContent>
    </j:ApplicationMainContent>

</j:ResponsiveView>